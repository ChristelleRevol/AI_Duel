<script>
        const monContainer = document.getElementById("unid");
        function toLeft(container, scrollDistance) {
          container.scrollBy({left: -scrollDistance, behavior: "smooth"});
        }

        function toRight(container, scrollDistance) {
          container.scrollBy({left: scrollDistance, behavior: "smooth"});
        }
  </script>

<script>
    document.addEventListener("turbo:load", function () {
        const cards = document.querySelectorAll(".prompt-card-third-row");
        const button = document.getElementById("loadMore");
        let visibleCount = 0; // Nombre d'éléments actuellement visibles

        function showMoreCards() {
            let nextCards = Array.from(cards).slice(visibleCount, visibleCount + 3);
            nextCards.forEach(card => card.classList.remove("hidden"));
            visibleCount += 3;

            // Cache le bouton si tous les éléments sont affichés
            if (visibleCount >= cards.length) {
                button.style.display = "none";
            }
        }

        // Afficher les 3 premiers éléments au chargement
        showMoreCards();

        // Ajouter un événement au bouton
        button.addEventListener("click", showMoreCards);
    });
</script>






<div class="index-container">
  <h1 class="title-index"> <%= "Welcome back, #{current_user.pseudo} !" %> </h1>

    <%# <div class="first-row-index"> %>
      <%# <h2 class="second-title">My stats</h2> %>
      <div class="index-first-row">
        <div class="user-infos">
          <div class="user-infos-image"><%= cl_image_tag current_user.photo.key, class: 'avatar-square-large' %></div>
          <div class="infos-user-left">
              <div class="avatar-text-lg"><%= current_user.pseudo %></div>
              <div class="user-infos-text">

                <div class="square-info">
                  <div class="square-info-title">Prompts</div>
                  <div class="square-info-bottom">
                    <i class="fa-solid fa-terminal"></i><span>123</span>
                  </div>
                </div>
                <div class="square-info">
                  <div class="square-info-title">Votes</div>
                  <div class="square-info-bottom">
                    <i class="fa-solid fa-heart"></i><span>321</span>
                  </div>
                </div>
                <div class="square-info">
                  <div class="square-info-title">Votes received</div>
                  <div class="square-info-bottom">
                    <i class="fa-solid fa-check-to-slot"></i><span>4221</span>
                  </div>
                </div>
                <div class="square-info">
                  <div class="square-info-title">Rank</div>
                  <div class="square-info-bottom">
                    <i class="fa-solid fa-ranking-star"></i><span>Noob</span>
                  </div>
                </div>

            </div>
          </div>
        </div>

          <div class="button"><%= button_to "Start a new battle", new_battle_path, method: :get, class: "button-new" %></div>

            <div class="ia-right">
              <div class="avatar-text-lg"><%= "IA" %></div>
              <div class="all-logos">
                  <div class="logo-with-name">
                    <div class="logo-name">Claude</div>
                    <%= image_tag "logos_ai/claude.png", alt: "logo", class: " logo" %>
                  </div>

                  <div class="logo-with-name">
                    <div class="logo-name">Deepseek</div>
                    <%= image_tag "logos_ai/deepseek.png", alt: "logo", class: "logo" %>
                  </div>

                  <div class="logo-with-name">
                    <div class="logo-name">Grok</div>
                    <%= image_tag "logos_ai/grok.png", alt: "logo", class: "logo" %>
                  </div>

                  <div class="logo-with-name">
                    <div class="logo-name">Mistral</div>
                    <%= image_tag "logos_ai/Mistral.png", alt: "logo", class: " logo" %>
                  </div>

                <div class="logo-with-name">
                  <div class="logo-name">ChatGPT</div>
                  <%= image_tag "logos_ai/chatgpt.png", alt: "logo", class: " logo" %>
                </div>

                <div class="logo-with-name">
                  <div class="logo-name">Meta</div>
                  <%= image_tag "logos_ai/meta.png", alt: "logo", class: " logo" %>
                </div>
            </div>
          </div>
      </div>
    <%# </div> %>



    <%# <div class="second-row-index"> %>
      <h2 class="second-title">My battles</h2>
        <div class="index-second-row" id="unid">

          <% @battles.each do |battle| %>
              <%= link_to battle_path(battle), class: 'text-decoration-none' do %>
                <div class="prompt-card">
                  <div class="prompt-top"><p><%= battle.prompt %></p></div>

                    <div class="prompt-card-body">
                      <div class="category"><%= battle.category.capitalize %></div>
                        <div class="last-elements-card">
                          <div class="pseudo"><%= "Prompted by: #{battle.user.pseudo}" %></div>
                          <div class="status"><%= status = battle.winner ? "Closed" : "In Progress" %></div>
                        </div>
                    </div>
                </div>
              <% end %>
          <% end %>


        </div>
          <div class="button-row">
            <button class="button-slide" onclick="toLeft(unid, 500)"><i class="fa-solid fa-arrow-left"></i></button>
            <button class="button-slide" onclick="toRight(unid, 500)"><i class="fa-solid fa-arrow-right"></i></button>
          </div>

    <%# </div> %>






    <div class="third-row-index">
      <h2 class="second-title">Opened battles</h2>
        <div class="index-third-row" id="itemContainer">

          <% @battles.each do |battle| %>
              <%= link_to battle_path(battle), class: 'text-decoration-none' do %>
                <div class="prompt-card-third-row hidden">
                  <div class="prompt-top"><p><%= battle.prompt %></p></div>

                    <div class="prompt-card-body">
                      <div class="category"><%= battle.category.capitalize %></div>
                        <div class="last-elements-card">
                          <div class="pseudo"><%= "Prompted by: #{battle.user.pseudo}" %></div>
                          <div class="status"><%= status = battle.winner ? "Closed" : "In Progress" %></div>
                        </div>
                    </div>
                </div>
              <% end %>
          <% end %>

        </div>

        <div class="button-row"><button id="loadMore" class="button-slide">Show more</button></div>

      </div>


    <div class="fourth-row-index">
      <h2 class="second-title">History</h2>
        <div class="index-fourth-row">

          <% @battles.each do |battle| %>
              <%= link_to battle_path(battle), class: 'text-decoration-none' do %>
                <div class="prompt-card">
                  <div class="prompt-top"><p><%= battle.prompt %></p></div>

                    <div class="prompt-card-body">
                      <div class="category"><%= battle.category.capitalize %></div>
                        <div class="last-elements-card">
                          <div class="pseudo"><%= "Prompted by: #{battle.user.pseudo}" %></div>
                          <div class="status"><%= status = battle.winner ? "Closed" : "In Progress" %></div>
                        </div>
                    </div>
                </div>
              <% end %>
          <% end %>

        </div>

        <div class="button-row"><div class="button-slide"><%= link_to "See all history", history_battles_path, class: 'text-decoration-none' %></div></div>

    </div>


</div>
