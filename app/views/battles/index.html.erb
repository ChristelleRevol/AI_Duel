<script>
        const monContainer = document.getElementById("unid");
        function toLeft(container, scrollDistance) {
          container.scrollBy({left: -scrollDistance, behavior: "smooth"});
        }

        function toRight(container, scrollDistance) {
          container.scrollBy({left: scrollDistance, behavior: "smooth"});
        }
  </script>

<script>
    document.addEventListener("turbo:load", function () {
        const cards = document.querySelectorAll(".prompt-card-third-row");
        const button = document.getElementById("loadMore");
        let visibleCount = 0; // Nombre d'éléments actuellement visibles

        function showMoreCards() {
            let nextCards = Array.from(cards).slice(visibleCount, visibleCount + 3);
            nextCards.forEach(card => card.classList.remove("hidden"));
            visibleCount += 3;

            // Cache le bouton si tous les éléments sont affichés
            if (visibleCount >= cards.length) {
                button.style.display = "none";
            }
        }

        // Afficher les 3 premiers éléments au chargement
        showMoreCards();

        // Ajouter un événement au bouton
        button.addEventListener("click", showMoreCards);
    });
</script>






<div class="index-container">
  <h1 class="title-index"> <%= "Welcome back, #{current_user.pseudo} !" %> </h1>
    <div class="first-row-index">
      <h2 class="second-title">My stats</h2>
      <div class="index-first-row">
        <div class="user-infos">
          <div class="user-infos-image">
            <%= cl_image_tag current_user.photo.key, class: 'avatar-square-large' %>
          </div>

          <div class="user-infos-text">
            <span class="avatar-text"><%= current_user.pseudo %></span>
            <span class="avatar-text"><%= "You have voted 123 times"%></span>
            <span class="avatar-text"><%= "You have made 321 prompts" %></span>
            <span class="avatar-text"><%= "Your prompts have received a total of 4221 votes" %></span>
            <span class="avatar-text"><%= "Current rank : Noob" %></span>
          </div>
        </div>


      <div class="button"><%= button_to "Start a new battle", new_battle_path, method: :get, class: "button-new" %></div>


        <div class="icon-ai">

          <%= image_tag "logos_ai/claude.png", alt: "logo", class: " logo logo-ai-claude" %>
          <%= image_tag "logos_ai/deepseek.png", alt: "logo", class: "logo logo-ai-deepseek" %>
          <%#= image_tag "logos_ai/gemini.png", alt: "logo", class: "logo-ai" %>
          <%= image_tag "logos_ai/grok.png", alt: "logo", class: "logo logo-ai-grok" %>
          <%#= image_tag "logos_ai/meta.png", alt: "logo", class: "logo-ai" %>
          <%= image_tag "logos_ai/Mistral.png", alt: "logo", class: "logo logo-ai-mistral" %>
          <%#= image_tag "logos_ai/open_ai.png", alt: "logo", class: "logo-ai" %>



        </div>



      </div>
    </div>



    <div class="second-row-index">
      <h2 class="second-title">My battles</h2>
        <div class="index-second-row" id="unid">

          <% @battles.each do |battle| %>
              <%= link_to battle_path(battle), class: 'text-decoration-none' do %>
                <div class="prompt-card">
                  <div class="prompt-top"><p><%= battle.prompt %></p></div>

                    <div class="prompt-card-body">
                      <div class="category"><%= battle.category.capitalize %></div>
                        <div class="last-elements-card">
                          <div class="pseudo"><%= "Prompted by: #{battle.user.pseudo}" %></div>
                          <div class="status"><%= status = battle.winner ? "Closed" : "In Progress" %></div>
                        </div>
                    </div>
                </div>
              <% end %>
          <% end %>


        </div>
          <div class="button-row">
            <button class="button-slide" onclick="toLeft(unid, 500)"><i class="fa-solid fa-arrow-left"></i></button>
            <button class="button-slide" onclick="toRight(unid, 500)"><i class="fa-solid fa-arrow-right"></i></button>
          </div>

    </div>






    <div class="third-row-index">
      <h2 class="second-title">Opened battles</h2>
        <div class="index-third-row" id="itemContainer">

          <% @battles.each do |battle| %>
              <%= link_to battle_path(battle), class: 'text-decoration-none' do %>
                <div class="prompt-card-third-row hidden">
                  <div class="prompt-top"><p><%= battle.prompt %></p></div>

                    <div class="prompt-card-body">
                      <div class="category"><%= battle.category.capitalize %></div>
                        <div class="last-elements-card">
                          <div class="pseudo"><%= "Prompted by: #{battle.user.pseudo}" %></div>
                          <div class="status"><%= status = battle.winner ? "Closed" : "In Progress" %></div>
                        </div>
                    </div>
                </div>
              <% end %>
          <% end %>

        </div>

        <div class="button-row"><button id="loadMore" class="button-slide">Show more</button></div>

      </div>


    <div class="fourth-row-index">
      <h2 class="second-title">History</h2>
        <div class="index-fourth-row">

          <% @battles.each do |battle| %>
              <%= link_to battle_path(battle), class: 'text-decoration-none' do %>
                <div class="prompt-card">
                  <div class="prompt-top"><p><%= battle.prompt %></p></div>

                    <div class="prompt-card-body">
                      <div class="category"><%= battle.category.capitalize %></div>
                        <div class="last-elements-card">
                          <div class="pseudo"><%= "Prompted by: #{battle.user.pseudo}" %></div>
                          <div class="status"><%= status = battle.winner ? "Closed" : "In Progress" %></div>
                        </div>
                    </div>
                </div>
              <% end %>
          <% end %>

        </div>

        <div class="button-row"><div class="button-slide"><%= link_to "See all history", history_battles_path, class: 'text-decoration-none' %></div></div>

    </div>


</div>
